   
## This was before the group data collected in March
Loading best model from /work/ajgeglio/pretrained_models/checkpoint-3922_Feb-16-2023-17:03_tap2key/checkpoint-6808 (score: 0.8076023853348172).
{'train_runtime': 25164.0864, 'train_samples_per_second': 94.281, 'train_steps_per_second': 0.735, 'train_loss': 0.7083764100912455, 'epoch': 250.0}
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18500/18500 [6:59:24<00:00100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 18500/18500 [6:59:24<00:00,  1.36s/it]
***** Running Evaluation *****
Num examples = 1340
Batch size = 32
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 42/42 [00:06<00:00,  6.70it/s]
TOTAL TIME: 25203.40
### Report
	               	 precision   	 recall    	 f1-score  	 support   
	 _1            	 0.45        	 0.56      	 0.50      	 9         
	 _2            	 0.93        	 0.64      	 0.76      	 83        
	 _3            	 0.55        	 0.74      	 0.63      	 42        
	 _4            	 0.56        	 0.62      	 0.59      	 29        
	 _5            	 0.62        	 0.84      	 0.71      	 31        
	 _6            	 0.71        	 0.96      	 0.81      	 23        
	 a             	 0.93        	 0.96      	 0.94      	 67        
	 b             	 0.68        	 0.70      	 0.69      	 30        
	 c             	 0.75        	 0.56      	 0.64      	 32        
	 d             	 0.90        	 0.90      	 0.90      	 31        
	 e             	 0.97        	 0.86      	 0.91      	 72        
	 f             	 0.79        	 0.87      	 0.82      	 38        
	 g             	 0.44        	 1.00      	 0.61      	 27        
	 h             	 0.77        	 0.98      	 0.86      	 51        
	 i             	 0.95        	 0.84      	 0.89      	 67        
	 j             	 0.00        	 0.00      	 0.00      	 24        
	 k             	 0.77        	 1.00      	 0.87      	 23        
	 l             	 0.92        	 0.81      	 0.86      	 27        
	 m             	 0.69        	 0.69      	 0.69      	 29        
	 n             	 0.76        	 0.90      	 0.83      	 42        
	 none          	 1.00        	 0.25      	 0.40      	 4         
	 o             	 1.00        	 0.97      	 0.99      	 76        
	 p             	 0.92        	 0.94      	 0.93      	 48        
	 q             	 0.84        	 0.75      	 0.79      	 28        
	 r             	 0.88        	 0.75      	 0.81      	 48        
	 s             	 0.89        	 0.92      	 0.90      	 60        
	 t             	 0.92        	 0.87      	 0.90      	 54        
	 u             	 0.82        	 0.88      	 0.85      	 52        
	 v             	 0.56        	 0.43      	 0.49      	 21        
	 w             	 0.95        	 0.81      	 0.88      	 26        
	 x             	 0.69        	 0.73      	 0.71      	 30        
	 y             	 1.00        	 0.71      	 0.83      	 49        
	 z             	 0.88        	 0.85      	 0.87      	 34        
	 |	             0.97        	 0.94      	 0.96      	 34        
### Result					
	 accuracy      	             	           	 0.81      	 1341      
	 macro avg     	 0.78        	 0.77      	 0.76      	 1341      
	 weighted avg  	 0.82        	 0.81      	 0.81      	 1341      


## New group data not oversampled
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Mar-06-2023-12:34_tap2key/checkpoint-9256 (score: 0.8473827218292356).
{'train_runtime': 22574.1536, 'train_samples_per_second': 101.514, 'train_steps_per_second': 0.789, 'train_loss': 1.1521373021736574, 'epoch': 199.99}
100%|████████████████████████████████████████████████████████████████████████100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17800/17800 [6:16:14<00:00,  1.27s/it]
***** Running Evaluation *****
Num examples = 2455
Batch size = 32
100%|████████████████████████████████████████| 77/77 [00:10<00:00,  7.10it/s]
TOTAL TIME: 22608.78
### Report
                precision   	 recall  	 f1-score  	 support   
	 _1            	 0.71        	 0.45    	 0.55      	 38        
	 _2            	 0.71        	 0.86    	 0.78      	 74        
	 _3            	 0.70        	 0.64    	 0.67      	 44        
	 _4            	 0.71        	 0.82    	 0.76      	 68        
	 _5            	 0.87        	 0.95    	 0.91      	 102       
	 _6            	 0.92        	 0.87    	 0.89      	 63        
	 a             	 0.94        	 0.93    	 0.93      	 124       
	 b             	 0.79        	 0.91    	 0.85      	 58        
	 c             	 0.90        	 0.84    	 0.87      	 67        
	 d             	 0.85        	 0.94    	 0.89      	 62        
	 e             	 0.94        	 0.92    	 0.93      	 133       
	 f             	 0.79        	 0.91    	 0.85      	 58        
	 g             	 0.80        	 0.92    	 0.85      	 48        
	 h             	 0.82        	 0.73    	 0.78      	 83        
	 i             	 0.88        	 0.87    	 0.88      	 119       
	 j             	 0.74        	 0.88    	 0.80      	 49        
	 k             	 0.79        	 0.82    	 0.80      	 45        
	 l             	 0.80        	 0.92    	 0.86      	 52        
	 m             	 0.81        	 0.81    	 0.81      	 52        
	 n             	 0.87        	 0.92    	 0.89      	 71        
	 none          	 0.87        	 0.78    	 0.82      	 67        
	 o             	 0.92        	 0.89    	 0.90      	 137       
	 p             	 0.96        	 0.92    	 0.94      	 71        
	 q             	 0.89        	 0.80    	 0.84      	 49        
	 r             	 0.95        	 0.88    	 0.91      	 85        
	 s             	 0.92        	 0.91    	 0.91      	 106       
	 t             	 0.90        	 0.92    	 0.91      	 103       
	 u             	 0.84        	 0.80    	 0.82      	 101       
	 v             	 0.75        	 0.68    	 0.71      	 40        
	 w             	 0.80        	 0.78    	 0.79      	 46        
	 x             	 0.71        	 0.72    	 0.71      	 50        
	 y             	 0.88        	 0.83    	 0.85      	 88        
	 z             	 0.91        	 0.80    	 0.85      	 60        
	 |	             0.87        	 0.77    	 0.81      	 43        
### Result					
	 accuracy      	             	         	 0.85      	 2456      
	 macro avg     	 0.84        	 0.83    	 0.83      	 2456      
	 weighted avg  	 0.86        	 0.85    	 0.85      	 2456      



## All data, (average channel), oversampled to class balance, early stop
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Mar-21-2023-13:11_tap2key/checkpoint-6929 (score: 0.8425779219463057).
{'train_runtime': 12813.4565, 'train_samples_per_second': 253.538, 'train_steps_per_second': 1.978, 'train_loss': 1.621444588397707, 'epoch': 65.0}   
 43%|████████████████████████████████████████████▋                                                          | 10985/25350 [3:33:33<4:39:16,  1.17s/it]
***** Running Evaluation *****
  Num examples = 2455
  Batch size = 32
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:10<00:00,  7.51it/s]
TOTAL TIME: 12856.13
***** Running Prediction *****
Sample rate: None , sample len (s): 10928 , waveform shape: (10928,)
  Num examples = 2456
  Batch size = 32
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 76/77 [00:09<00:00,  8.62it/s]
### Report
               precision    recall  f1-score   support

          _1       0.80      0.74      0.77        38
          _2       0.88      0.82      0.85        74
          _3       0.81      0.80      0.80        44
          _4       0.69      0.75      0.72        68
          _5       0.84      0.75      0.79       102
          _6       0.85      0.81      0.83        63
           a       0.85      0.97      0.91       124
           b       0.76      0.93      0.84        58
           c       0.84      0.85      0.84        67
           d       0.83      0.92      0.87        62
           e       0.94      0.92      0.93       133
           f       0.86      0.88      0.87        58
           g       0.88      0.92      0.90        48
           h       0.93      0.82      0.87        83
           i       0.81      0.83      0.82       119
           j       0.79      0.76      0.77        49
           k       0.92      0.80      0.86        45
           l       0.98      0.98      0.98        52
           m       0.67      0.87      0.76        52
           n       0.86      0.85      0.85        71
        none       0.92      0.84      0.88        67
           o       0.91      0.88      0.89       137
           p       0.81      0.90      0.85        71
           q       0.88      0.86      0.87        49
           r       0.89      0.87      0.88        85
           s       0.95      0.85      0.90       106
           t       0.82      0.95      0.88       103
           u       0.76      0.85      0.80       101
           v       0.97      0.80      0.88        40
           w       0.89      0.72      0.80        46
           x       0.84      0.76      0.80        50
           y       0.89      0.74      0.81        88
           z       0.90      0.92      0.91        60
           |       0.95      0.98      0.97        43
### Result
    accuracy                           0.86      2456
   macro avg       0.86      0.85      0.85      2456
weighted avg       0.86      0.86      0.86      2456
## New Group Data (average channel) and oversampled (best test performance with avr channel)
best model:  /work/ajgeglio/pretrained_models/wav2vec2-base_Mar-07-2023-11:42_tap2key/checkpoint-7098 

***** Running Prediction *****
  Num examples = 2456
  Batch size = 32
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 76/77 [00:09<00:00,  7.82it/s]TOTAL TIME: 13.15
 ### Report
              precision    recall  f1-score   support

          _1       0.72      0.87      0.79        38
          _2       0.84      0.84      0.84        74
          _3       0.82      0.82      0.82        44
          _4       0.67      0.82      0.74        68
          _5       0.87      0.77      0.82       102
          _6       0.88      0.83      0.85        63
           a       0.88      0.96      0.92       124
           b       0.83      0.91      0.87        58
           c       0.86      0.94      0.90        67
           d       0.85      0.92      0.88        62
           e       0.91      0.93      0.92       133
           f       0.98      0.83      0.90        58
           g       0.91      0.90      0.91        48
           h       0.87      0.90      0.89        83
           i       0.90      0.81      0.85       119
           j       0.86      0.76      0.80        49
           k       0.83      0.78      0.80        45
           l       0.92      0.94      0.93        52
           m       0.93      0.73      0.82        52
           n       0.82      0.89      0.85        71
        none       0.90      0.85      0.88        67
           o       0.85      0.86      0.86       137
           p       0.84      0.92      0.88        71
           q       0.88      0.88      0.88        49
           r       0.85      0.89      0.87        85
           s       0.86      0.87      0.86       106
           t       0.94      0.91      0.93       103
           u       0.91      0.82      0.86       101
           v       0.89      0.85      0.87        40
           w       0.84      0.83      0.84        46
           x       0.84      0.86      0.85        50
           y       0.88      0.89      0.88        88
           z       0.95      0.92      0.93        60
           |       0.95      0.91      0.93        43
### Result
    accuracy                           0.87      2456
   macro avg       0.87      0.86      0.86      2456
weighted avg       0.87      0.87      0.87      2456

## This is with 50% of the data
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Mar-13-2023-13:38_tap2key/checkpoint-4224 (score: 0.76930715755231).
{'train_runtime': 5785.3594, 'train_samples_per_second': 148.513, 'train_steps_per_second': 1.141, 'train_loss': 2.156472315101231, 'epoch': 105.98} 
 71%|██████████████████████████████████████████████████████████████████████████▉                               | 4664/6600 [1:36:25<40:01,  1.24s/it]
***** Running Evaluation *****
  Num examples = 1228
  Batch size = 32
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:05<00:00,  7.16it/s]
TOTAL TIME: 5795.22
***** Running Prediction *****
  Num examples = 1228
  Batch size = 32
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 38/39 [00:06<00:00,  6.02it/s] 
 ### Report
              precision    recall  f1-score   support

          _1       0.55      0.55      0.55        20
          _2       0.59      0.68      0.63        34
          _3       0.52      0.50      0.51        24
          _4       0.61      0.70      0.65        33
          _5       0.82      0.57      0.67        49
          _6       0.71      0.97      0.82        31
           a       0.81      0.94      0.87        64
           b       0.70      0.70      0.70        27
           c       0.86      0.69      0.77        36
           d       0.87      0.90      0.89        30
           e       0.87      0.86      0.87        64
           f       0.64      0.88      0.74        26
           g       0.64      0.81      0.71        26
           h       0.74      0.83      0.78        41
           i       0.88      0.70      0.78        60
           j       0.47      0.35      0.40        26
           k       0.69      0.48      0.56        23
           l       0.50      0.80      0.62        25
           m       0.50      0.50      0.50        26
           n       0.63      0.71      0.67        38
        none       0.75      0.80      0.77        30
           o       0.82      0.81      0.81        67
           p       0.91      0.81      0.86        37
           q       0.72      0.81      0.76        26
           r       0.85      0.79      0.82        43
           s       0.76      0.85      0.80        53
           t       0.89      0.89      0.89        54
           u       0.78      0.71      0.74        49
           v       0.63      0.57      0.60        21
           w       0.60      0.39      0.47        23
           x       0.74      0.54      0.62        26
           y       0.77      0.70      0.73        43
           z       0.73      0.67      0.70        33
           |       0.71      0.75      0.73        20
### Results
    accuracy                           0.74      1228
   macro avg       0.71      0.71      0.71      1228
weighted avg       0.74      0.74      0.74      1228


## THis is with 60% of the data
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Mar-13-2023-18:04_tap2key/checkpoint-4982 (score: 0.7728566429170177).
{'train_runtime': 7364.9326, 'train_samples_per_second': 140.001, 'train_steps_per_second': 1.079, 'train_loss': 2.049334684952704, 'epoch': 108.99}  
 73%|█████████████████████████████████████████████████████████████████████████████▊                             | 5777/7950 [2:02:44<46:10,  1.27s/it]
***** Running Evaluation *****
  Num examples = 1473
  Batch size = 32
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 47/47 [00:06<00:00,  7.63it/s]
TOTAL TIME: 7539.96
***** Running Prediction *****
  Num examples = 1474
  Batch size = 32
 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▌  | 46/47 [00:05<00:00,  7.83it/s]              precision    recall  f1-score   support

          _1       0.67      0.75      0.71        24
          _2       0.82      0.74      0.78        43
          _3       0.60      0.54      0.57        28
          _4       0.49      0.51      0.50        39
          _5       0.75      0.85      0.80        61
          _6       0.82      0.76      0.79        37
           a       0.82      0.91      0.86        78
           b       0.68      0.74      0.71        35
           c       0.83      0.79      0.81        43
           d       0.94      0.82      0.87        38
           e       0.93      0.87      0.90        76
           f       0.72      0.81      0.76        32
           g       0.74      0.90      0.81        29
           h       0.92      0.69      0.79        49
           i       0.90      0.49      0.64        71
           j       0.65      0.77      0.71        31
           k       0.81      0.61      0.69        28
           l       0.68      0.84      0.75        31
           m       0.50      0.55      0.52        31
           n       0.68      0.85      0.76        46
        none       0.79      0.84      0.82        37
           o       0.81      0.94      0.87        81
           p       0.64      0.80      0.71        44
           q       0.75      0.70      0.72        30
           r       0.77      0.90      0.83        51
           s       0.87      0.84      0.85        63
           t       0.85      0.90      0.88        63
           u       0.89      0.77      0.82        61
           v       0.80      0.50      0.62        24
           w       0.46      0.41      0.43        27
           x       0.76      0.76      0.76        29
           y       0.86      0.73      0.79        51
           z       0.86      0.77      0.81        39
           |       0.56      0.75      0.64        24

    accuracy                           0.77      1474
   macro avg       0.75      0.75      0.74      1474
weighted avg       0.78      0.77      0.77      1474


## This is with 70% of the data
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Mar-14-2023-09:54_tap2key/checkpoint-7378 (score: 0.8011729042543464).
{'train_runtime': 10289.9239, 'train_samples_per_second': 116.91, 'train_steps_per_second': 0.904, 'train_loss': 2.0511371299631618, 'epoch': 133.99} 
 89%|███████████████████████████████████████████████████████████████████████████████████████████████▌           | 8308/9300 [2:51:29<20:28,  1.24s/it]
***** Running Evaluation *****
  Num examples = 1719
  Batch size = 32
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 54/54 [00:07<00:00,  7.66it/s]
TOTAL TIME: 10498.95
***** Running Prediction *****
  Num examples = 1719
  Batch size = 32
 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 53/54 [00:06<00:00,  8.14it/s]              precision    recall  f1-score   support

          _1       0.73      0.89      0.80        27
          _2       0.82      0.92      0.87        49
          _3       0.67      0.69      0.68        32
          _4       0.62      0.72      0.67        47
          _5       0.75      0.76      0.75        70
          _6       0.87      0.77      0.81        43
           a       0.82      0.93      0.87        90
           b       0.74      0.68      0.71        41
           c       0.71      0.74      0.73        47
           d       0.79      0.84      0.81        44
           e       0.86      0.93      0.89        91
           f       0.77      0.77      0.77        39
           g       0.65      0.65      0.65        34
           h       0.83      0.70      0.76        57
           i       0.81      0.75      0.77        83
           j       0.65      0.49      0.56        35
           k       0.75      0.73      0.74        33
           l       0.89      0.65      0.75        37
           m       0.69      0.50      0.58        36
           n       0.76      0.92      0.83        52
        none       0.87      0.87      0.87        45
           o       0.78      0.87      0.82        93
           p       0.84      0.86      0.85        50
           q       0.82      0.66      0.73        35
           r       0.86      0.83      0.85        60
           s       0.87      0.80      0.84        76
           t       0.88      0.92      0.90        72
           u       0.66      0.81      0.73        70
           v       0.81      0.61      0.69        28
           w       0.58      0.64      0.61        33
           x       0.87      0.74      0.80        35
           y       0.77      0.74      0.75        62
           z       0.71      0.66      0.68        44
           |       0.82      0.62      0.71        29

    accuracy                           0.78      1719
   macro avg       0.77      0.75      0.76      1719
weighted avg       0.78      0.78      0.78      1719

## This is with 80% of the data
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Mar-14-2023-14:15_tap2key/checkpoint-5254 (score: 0.8255407605885805).
{'train_runtime': 7891.7362, 'train_samples_per_second': 174.22, 'train_steps_per_second': 1.35, 'train_loss': 2.0513589594593946, 'epoch': 88.99}    
 59%|█████████████████████████████████████████████████████████████▋                                          | 6319/10650 [2:11:31<1:30:08,  1.25s/it]
***** Running Evaluation *****
  Num examples = 1964
  Batch size = 32
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 62/62 [00:07<00:00,  7.76it/s]
TOTAL TIME: 8098.20
***** Running Prediction *****
  Num examples = 1965
  Batch size = 32
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 61/62 [00:08<00:00,  7.24it/s]                
Dataset({
    features: ['label', 'input_values'],
    num_rows: 1965
})
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 62/62 [00:07<00:00,  8.41it/s]
              precision    recall  f1-score   support

          _1       0.64      0.70      0.67        30
          _2       0.70      0.68      0.69        56
          _3       0.58      0.59      0.59        37
          _4       0.68      0.59      0.63        54
          _5       0.78      0.86      0.82        80
          _6       0.94      0.68      0.79        50
           a       0.85      0.91      0.88       103
           b       0.69      0.96      0.80        47
           c       0.78      0.93      0.85        54
           d       0.94      0.69      0.80        49
           e       0.94      0.91      0.93       104
           f       0.77      0.96      0.85        45
           g       0.68      0.89      0.77        38
           h       0.84      0.86      0.85        65
           i       0.93      0.83      0.88        96
           j       0.86      0.79      0.83        39
           k       0.67      0.81      0.73        36
           l       0.89      0.83      0.86        41
           m       0.64      0.68      0.66        41
           n       0.80      0.95      0.87        58
        none       0.96      0.89      0.92        53
           o       0.88      0.87      0.87       108
           p       0.91      0.88      0.89        57
           q       0.78      0.72      0.75        39
           r       0.92      0.80      0.85        69
           s       0.92      0.93      0.93        87
           t       0.96      0.87      0.91        82
           u       0.86      0.84      0.85        82
           v       0.71      0.73      0.72        33
           w       0.82      0.61      0.70        38
           x       0.76      0.56      0.65        39
           y       0.76      0.83      0.79        70
           z       0.81      0.76      0.79        51
           |       0.87      0.97      0.92        34

    accuracy                           0.82      1965
   macro avg       0.81      0.80      0.80      1965
weighted avg       0.83      0.82      0.82      1965

## This is with 90% of the data, no oversampling
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Mar-15-2023-08:26_tap2key/checkpoint-6560 (score: 0.8607196325910811).
{'train_runtime': 9641.9812, 'train_samples_per_second': 160.423, 'train_steps_per_second': 1.245, 'train_loss': 1.9138727003458849, 'epoch': 96.99}  
 65%|███████████████████████████████████████████████████████████████████▎                                    | 7760/12000 [2:40:41<1:27:48,  1.24s/it]
***** Running Evaluation *****
  Num examples = 2210
  Batch size = 32
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:09<00:00,  7.58it/s]
TOTAL TIME: 9889.01
***** Running Prediction *****
  Num examples = 2210
  Batch size = 32
 99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▍ | 69/70 [00:08<00:00,  7.67it/s] 
 ### Report
              precision    recall  f1-score   support

          _1       0.68      0.58      0.62        33
          _2       0.78      0.77      0.77        64
          _3       0.61      0.66      0.64        41
          _4       0.64      0.68      0.66        60
          _5       0.84      0.84      0.84        90
          _6       0.80      0.93      0.86        57
           a       0.91      0.90      0.91       113
           b       0.75      0.83      0.79        53
           c       0.83      0.85      0.84        59
           d       0.96      0.84      0.90        56
           e       0.96      0.92      0.94       118
           f       0.90      0.88      0.89        52
           g       0.81      0.91      0.86        43
           h       0.94      0.80      0.86        74
           i       0.90      0.89      0.89       109
           j       0.75      0.89      0.81        44
           k       0.77      0.82      0.80        40
           l       0.79      0.72      0.76        47
           m       0.74      0.63      0.68        46
           n       0.74      0.89      0.81        65
        none       0.87      0.88      0.88        60
           o       0.90      0.86      0.88       121
           p       0.86      0.95      0.90        64
           q       0.95      0.80      0.86        44
           r       0.86      0.87      0.87        78
           s       0.81      0.94      0.87        96
           t       0.93      0.93      0.93        92
           u       0.87      0.85      0.86        93
           v       0.76      0.84      0.79        37
           w       0.84      0.74      0.78        42
           x       0.84      0.82      0.83        45
           y       0.94      0.86      0.90        78
           z       0.86      0.75      0.80        56
           |       0.97      0.90      0.94        40
### Result
    accuracy                           0.85      2210
   macro avg       0.83      0.83      0.83      2210
weighted avg       0.85      0.85      0.85      2210

## This is with 100% of data, flattening the channels to 8x signal length, and oversampling
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Mar-19-2023-18:40_tap2key/checkpoint-6084 (score: 0.9369977447824782).
{'train_runtime': 107480.9413, 'train_samples_per_second': 30.226, 'train_steps_per_second': 0.236, 'train_loss': 0.6116511644492386, 'epoch': 60.0}  
 40%|████████████████████████████████████████▍                                                            | 10140/25350 [29:51:20<44:47:01, 10.60s/it]
***** Running Evaluation *****
  Num examples = 2455
  Batch size = 32
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [01:10<00:00,  1.09it/s]
TOTAL TIME: 107621.50
***** Running Prediction *****
  Num examples = 2456
  Batch size = 32
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [01:03<00:00,  1.28it/s]              
### Report
                precision    recall  f1-score   support
          _1       0.83      0.92      0.88        38
          _2       0.93      0.89      0.91        74
          _3       0.86      0.98      0.91        44
          _4       0.80      0.84      0.82        68
          _5       0.93      0.77      0.84       102
          _6       0.94      0.95      0.94        63
           a       0.98      0.96      0.97       124
           b       0.95      1.00      0.97        58
           c       0.97      0.90      0.93        67
           d       0.92      0.97      0.94        62
           e       0.97      0.98      0.98       133
           f       0.93      0.98      0.96        58
           g       0.98      0.98      0.98        48
           h       0.98      0.96      0.97        83
           i       0.96      0.95      0.95       119
           j       0.89      0.98      0.93        49
           k       0.93      0.96      0.95        45
           l       0.98      0.98      0.98        52
           m       0.89      0.94      0.92        52
           n       0.87      0.96      0.91        71
        none       0.98      0.93      0.95        67
           o       0.97      0.95      0.96       137
           p       0.99      0.96      0.97        71
           q       0.96      0.98      0.97        49
           r       0.95      0.94      0.95        85
           s       0.99      0.93      0.96       106
           t       0.96      0.98      0.97       103
           u       0.97      0.92      0.94       101
           v       0.91      1.00      0.95        40
           w       1.00      0.96      0.98        46
           x       0.87      0.92      0.89        50
           y       0.97      0.97      0.97        88
           z       0.98      0.97      0.97        60
           |       0.93      0.98      0.95        43
### Result
    accuracy                           0.94      2456
   macro avg       0.94      0.95      0.94      2456
weighted avg       0.95      0.94      0.94      2456

## This is with 100% of data, oversampled, interleaving channels to 8x signal length - best performance overall - time length to 5 sec in feature extractor
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Mar-18-2023-11:13_tap2key/checkpoint-6422 (score: 0.9465413463734628).
{'train_runtime': 89427.3204, 'train_samples_per_second': 36.328, 'train_steps_per_second': 0.283, 'train_loss': 0.7443638917916966, 'epoch': 62.0}   
 41%|█████████████████████████████████████████▋                                                           | 10478/25350 [24:50:27<35:15:29,  8.53s/it]
***** Running Evaluation *****
  Num examples = 2455
  Batch size = 32
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [01:09<00:00,  1.10it/s]
TOTAL TIME: 89579.37
***** Running Prediction *****
  Num examples = 2456
  Batch size = 32
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [01:05<00:00,  1.26it/s]
### Report
              precision    recall  f1-score   support

          _1       0.83      0.89      0.86        38
          _2       0.93      0.89      0.91        74
          _3       0.85      0.89      0.87        44
          _4       0.86      0.97      0.91        68
          _5       0.95      0.92      0.94       102
          _6       0.98      0.90      0.94        63
           a       0.96      0.98      0.97       124
           b       0.98      0.90      0.94        58
           c       0.96      0.96      0.96        67
           d       0.88      0.97      0.92        62
           e       0.98      0.96      0.97       133
           f       0.97      0.98      0.97        58
           g       0.98      0.98      0.98        48
           h       0.96      0.98      0.97        83
           i       0.98      0.92      0.95       119
           j       0.89      0.96      0.92        49
           k       0.98      0.96      0.97        45
           l       1.00      1.00      1.00        52
           m       0.96      0.98      0.97        52
           n       0.99      0.97      0.98        71
        none       0.95      0.91      0.93        67
           o       0.96      0.96      0.96       137
           p       0.97      0.97      0.97        71
           q       0.96      0.92      0.94        49
           r       0.98      0.99      0.98        85
           s       0.98      0.96      0.97       106
           t       0.98      0.99      0.99       103
           u       0.95      0.94      0.95       101
           v       0.89      0.97      0.93        40
           w       0.92      0.96      0.94        46
           x       0.96      0.86      0.91        50
           y       0.97      0.94      0.95        88
           z       0.95      0.97      0.96        60
           |       0.91      1.00      0.96        43
### Result
    accuracy                           0.95      2456
   macro avg       0.95      0.95      0.95      2456
weighted avg       0.95      0.95      0.95      2456

## All data, oversampled, 48 khz, interleave chan, len 32,768
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Mar-22-2023-19:43_tap2key/checkpoint-3612 (score: 0.9351919943702868).
{'train_runtime': 22552.9054, 'train_samples_per_second': 144.048, 'train_steps_per_second': 0.559, 'train_loss': 1.0950490772194974, 'epoch': 58.99}
 39%|████████████████████████████████████████                                                              | 4956/12600 [6:15:52<9:39:44,  4.55s/it]
***** Running Evaluation *****
  Num examples = 2455
  Batch size = 64
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:27<00:00,  1.41it/s]
TOTAL TIME: 22614.34
Using amp half precision backend
***** Running Prediction *****
Sample rate: None , sample len (s): 32768 , waveform shape: (32768,)
  Num examples = 2456
  Batch size = 64
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:27<00:00,  1.72it/s]TOTAL TIME: 35.69
### Report
              precision    recall  f1-score   support

          _1       0.87      0.89      0.88        38
          _2       0.93      0.92      0.93        74
          _3       0.86      0.84      0.85        44
          _4       0.90      0.91      0.91        68
          _5       0.91      0.94      0.93       102
          _6       0.96      0.87      0.92        63
           a       0.98      0.96      0.97       124
           b       0.95      1.00      0.97        58
           c       0.96      1.00      0.98        67
           d       0.98      0.97      0.98        62
           e       0.96      0.97      0.97       133
           f       0.96      0.95      0.96        58
           g       0.98      0.96      0.97        48
           h       0.96      0.95      0.96        83
           i       0.98      0.95      0.97       119
           j       0.96      0.94      0.95        49
           k       0.96      0.96      0.96        45
           l       0.96      1.00      0.98        52
           m       0.96      0.96      0.96        52
           n       0.95      0.97      0.96        71
        none       0.91      0.90      0.90        67
           o       0.97      0.97      0.97       137
           p       0.99      0.94      0.96        71
           q       1.00      0.94      0.97        49
           r       0.91      0.98      0.94        85
           s       0.97      0.94      0.96       106
           t       0.99      0.97      0.98       103
           u       0.96      0.97      0.97       101
           v       0.93      1.00      0.96        40
           w       0.87      1.00      0.93        46
           x       0.94      0.94      0.94        50
           y       0.98      0.97      0.97        88
           z       0.97      0.98      0.98        60
           |       0.95      0.93      0.94        43
### Result
    accuracy                           0.95      2456
   macro avg       0.95      0.95      0.95      2456
weighted avg       0.95      0.95      0.95      2456


## All data, oversampled, 24 khz, interleave chan, len 16,384
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Mar-23-2023-09:08_tap2key/checkpoint-6216 (score: 0.9356112203006309).
{'train_runtime': 17553.7687, 'train_samples_per_second': 185.071, 'train_steps_per_second': 0.718, 'train_loss': 0.9871426894551232, 'epoch': 89.99}
 60%|█████████████████████████████████████████████████████████████▏                                        | 7560/12600 [4:52:33<3:15:02,  2.32s/it]
***** Running Evaluation *****
  Num examples = 2455
  Batch size = 64
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:14<00:00,  2.66it/s]
TOTAL TIME: 17590.23
Using amp half precision backend
***** Running Prediction *****
  Num examples = 2456
  Batch size = 64
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:13<00:00,  3.30it/s]TOTAL TIME: 17.79
### Report
              precision    recall  f1-score   support

          _1       0.78      0.82      0.79        38
          _2       0.89      0.89      0.89        74
          _3       0.86      0.84      0.85        44
          _4       0.84      0.91      0.87        68
          _5       0.92      0.90      0.91       102
          _6       0.95      0.95      0.95        63
           a       0.99      0.98      0.99       124
           b       0.95      0.98      0.97        58
           c       0.92      0.97      0.94        67
           d       0.94      0.97      0.95        62
           e       0.98      0.95      0.96       133
           f       0.97      0.97      0.97        58
           g       0.98      0.98      0.98        48
           h       0.96      0.95      0.96        83
           i       0.92      0.94      0.93       119
           j       0.92      0.94      0.93        49
           k       0.93      0.87      0.90        45
           l       0.98      1.00      0.99        52
           m       0.98      0.96      0.97        52
           n       0.96      0.97      0.97        71
        none       0.94      0.90      0.92        67
           o       0.98      0.93      0.95       137
           p       0.95      0.99      0.97        71
           q       0.98      0.96      0.97        49
           r       0.96      0.95      0.96        85
           s       1.00      0.95      0.98       106
           t       0.97      0.99      0.98       103
           u       0.95      0.92      0.93       101
           v       0.95      0.97      0.96        40
           w       0.87      0.98      0.92        46
           x       0.96      0.92      0.94        50
           y       0.97      0.95      0.96        88
           z       0.95      0.98      0.97        60
           |       0.98      0.98      0.98        43
### Results
    accuracy                           0.95      2456
   macro avg       0.94      0.94      0.94      2456
weighted avg       0.95      0.95      0.95      2456

## All data, oversampled, 16 khz, interleave chan, len 10,928
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Mar-23-2023-15:49_tap2key/checkpoint-6468 (score: 0.9278556868364308).
{'train_runtime': 12805.2285, 'train_samples_per_second': 253.701, 'train_steps_per_second': 0.984, 'train_loss': 1.2158351598934094, 'epoch': 92.99}
 62%|███████████████████████████████████████████████████████████████▏                                      | 7812/12600 [3:33:25<2:10:48,  1.64s/it]
***** Running Evaluation *****
  Num examples = 2455
  Batch size = 64
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:10<00:00,  3.70it/s]
TOTAL TIME: 12831.14
Using amp half precision backend
***** Running Prediction *****
  Num examples = 2456
  Batch size = 64
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:09<00:00,  4.60it/s]TOTAL TIME: 14.85
### Report
              precision    recall  f1-score   support

          _1       0.75      0.95      0.84        38
          _2       0.94      0.82      0.88        74
          _3       0.80      0.80      0.80        44
          _4       0.89      0.82      0.85        68
          _5       0.91      0.94      0.92       102
          _6       0.98      0.89      0.93        63
           a       0.96      0.93      0.94       124
           b       0.98      0.93      0.96        58
           c       0.97      0.96      0.96        67
           d       0.91      0.97      0.94        62
           e       0.97      0.93      0.95       133
           f       0.90      0.91      0.91        58
           g       0.96      1.00      0.98        48
           h       0.96      0.94      0.95        83
           i       0.97      0.92      0.94       119
           j       0.92      0.94      0.93        49
           k       0.95      0.91      0.93        45
           l       0.96      1.00      0.98        52
           m       0.94      0.94      0.94        52
           n       0.89      0.96      0.93        71
        none       0.95      0.93      0.94        67
           o       0.96      0.96      0.96       137
           p       0.99      0.97      0.98        71
           q       0.85      0.96      0.90        49
           r       0.96      0.94      0.95        85
           s       0.99      0.97      0.98       106
           t       0.96      0.98      0.97       103
           u       0.89      0.96      0.92       101
           v       0.85      1.00      0.92        40
           w       0.91      0.89      0.90        46
           x       0.92      0.92      0.92        50
           y       0.98      0.92      0.95        88
           z       0.89      0.92      0.90        60
           |       0.93      0.98      0.95        43
### Results
    accuracy                           0.94      2456
   macro avg       0.93      0.93      0.93      2456
weighted avg       0.94      0.94      0.94      2456

## This is with 100% of the data, max absolute value from each channel, oversampling to class balance, early stop
{'eval_loss': 2.604224920272827, 'eval_f1': 0.5135749813495983, 'eval_runtime': 12.4904, 'eval_samples_per_second': 196.552, 'eval_steps_per_second': 6.165, 'epoch': 55.0}                                                                                                                                 
{'train_runtime': 11367.7913, 'train_samples_per_second': 285.781, 'train_steps_per_second': 2.23, 'train_loss': 1.8054160225478477, 'epoch': 55.0}   
 37%|██████████████████████████████████████▏                                                                 | 9308/25350 [3:09:27<5:26:31,  1.22s/it]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:11<00:00,  6.84it/s]
TOTAL TIME: 11391.86
Dataset({                                                                                                                                             
    features: ['label', 'input_values'],
    num_rows: 2456
})
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 77/77 [00:10<00:00,  7.13it/s]
### Report
              precision    recall  f1-score   support

          _1       0.67      0.42      0.52        38
          _2       0.62      0.78      0.69        74
          _3       0.47      0.34      0.39        44
          _4       0.41      0.44      0.42        68
          _5       0.51      0.57      0.54       102
          _6       0.72      0.68      0.70        63
           a       0.86      0.72      0.78       124
           b       0.45      0.57      0.50        58
           c       0.67      0.52      0.59        67
           d       0.64      0.81      0.71        62
           e       0.78      0.68      0.73       133
           f       0.80      0.64      0.71        58
           g       0.54      0.88      0.67        48
           h       0.48      0.53      0.51        83
           i       0.61      0.72      0.66       119
           j       0.42      0.51      0.46        49
           k       0.49      0.56      0.52        45
           l       0.79      0.44      0.57        52
           m       0.27      0.31      0.29        52
           n       0.45      0.42      0.44        71
        none       0.85      0.78      0.81        67
           o       0.66      0.58      0.62       137
           p       0.80      0.52      0.63        71
           q       0.97      0.67      0.80        49
           r       0.78      0.82      0.80        85
           s       0.70      0.81      0.75       106
           t       0.72      0.69      0.71       103
           u       0.44      0.58      0.50       101
           v       0.46      0.62      0.53        40
           w       0.58      0.65      0.61        46
           x       0.76      0.62      0.68        50
           y       0.65      0.60      0.62        88
           z       0.77      0.73      0.75        60
           |       0.81      0.40      0.53        43
### Result
    accuracy                           0.62      2456
   macro avg       0.64      0.61      0.61      2456
weighted avg       0.65      0.62      0.63      2456

## Top Microphones, 16 khz, oversampled
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Mar-24-2023-11:11_tap2key/checkpoint-6720 (score: 0.8585833956505743).
{'train_runtime': 7504.7451, 'train_samples_per_second': 432.886, 'train_steps_per_second': 1.679, 'train_loss': 1.014140510192466, 'epoch': 95.99} 
 64%|█████████████████████████████████████████████████████████████████▎                                    | 8064/12600 [2:05:04<1:10:21,  1.07it/s]
***** Running Evaluation *****
  Num examples = 2455
  Batch size = 64
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:05<00:00,  6.91it/s]
TOTAL TIME: 7521.65
Sample rate: None , sample len (s): 5464 , waveform shape: (5464,)
Using amp half precision backend                                                                                                                    
***** Running Prediction *****
  Num examples = 2456
  Batch size = 64
 97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▏  | 38/39 [00:05<00:00,  7.19it/s]TOTAL TIME: 9.48
 ### Report
              precision    recall  f1-score   support

          _1       0.73      0.71      0.72        38
          _2       0.83      0.78      0.81        74
          _3       0.71      0.39      0.50        44
          _4       0.67      0.76      0.71        68
          _5       0.87      0.85      0.86       102
          _6       0.93      0.86      0.89        63
           a       0.86      0.94      0.90       124
           b       0.73      0.95      0.83        58
           c       0.88      0.90      0.89        67
           d       0.94      0.95      0.94        62
           e       0.84      0.95      0.89       133
           f       0.84      0.93      0.89        58
           g       0.88      0.88      0.88        48
           h       0.92      0.66      0.77        83
           i       0.86      0.88      0.87       119
           j       0.81      0.78      0.79        49
           k       0.92      0.73      0.81        45
           l       0.96      0.92      0.94        52
           m       0.87      0.90      0.89        52
           n       0.70      0.96      0.81        71
        none       0.77      0.94      0.85        67
           o       0.91      0.93      0.92       137
           p       0.90      0.93      0.92        71
           q       0.85      0.94      0.89        49
           r       0.94      0.73      0.82        85
           s       0.91      0.89      0.90       106
           t       0.96      0.88      0.92       103
           u       0.82      0.84      0.83       101
           v       0.79      0.78      0.78        40
           w       0.92      0.76      0.83        46
           x       0.89      0.80      0.84        50
           y       0.94      0.77      0.85        88
           z       0.90      0.93      0.92        60
           |       0.93      0.98      0.95        43
### Results
    accuracy                           0.86      2456
   macro avg       0.86      0.85      0.85      2456
weighted avg       0.86      0.86      0.86      2456

## Bottom Microphones, 16 khz, oversampled
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Mar-24-2023-18:40_tap2key/checkpoint-7476 (score: 0.8626628807666809).
{'train_runtime': 8093.4022, 'train_samples_per_second': 401.401, 'train_steps_per_second': 1.557, 'train_loss': 0.9516626268853339, 'epoch': 104.99}
 70%|████████████████████████████████████████████████████████████████████████▊                               | 8820/12600 [2:14:53<57:48,  1.09it/s]
***** Running Evaluation *****
  Num examples = 2455
  Batch size = 64
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:05<00:00,  7.04it/s]
TOTAL TIME: 8102.67
Sample rate: None , sample len (s): 5464 , waveform shape: (5464,)
Loading cached processed dataset at /work/ajgeglio/Tap_Data/11.All_Dataset_96k/evaluation/cache-35e8441b15417d32.arrow
Using amp half precision backend
***** Running Prediction *****
  Num examples = 2456
  Batch size = 64
 97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▏  | 38/39 [00:05<00:00,  7.18it/s]TOTAL TIME: 11.19
 ### Report
              precision    recall  f1-score   support

          _1       0.69      0.95      0.80        38
          _2       0.83      0.80      0.81        74
          _3       0.69      0.75      0.72        44
          _4       0.69      0.90      0.78        68
          _5       0.90      0.72      0.80       102
          _6       0.93      0.83      0.87        63
           a       0.87      0.98      0.92       124
           b       0.80      0.91      0.85        58
           c       0.77      0.75      0.76        67
           d       0.78      0.95      0.86        62
           e       0.88      0.91      0.89       133
           f       0.90      0.79      0.84        58
           g       0.91      0.65      0.76        48
           h       0.91      0.86      0.88        83
           i       0.95      0.87      0.91       119
           j       0.91      0.88      0.90        49
           k       0.95      0.84      0.89        45
           l       0.94      0.88      0.91        52
           m       0.79      0.88      0.84        52
           n       0.90      0.90      0.90        71
        none       0.89      0.82      0.85        67
           o       0.95      0.91      0.93       137
           p       0.88      0.94      0.91        71
           q       0.74      0.94      0.83        49
           r       0.94      0.74      0.83        85
           s       0.95      0.82      0.88       106
           t       0.98      0.88      0.93       103
           u       0.83      0.91      0.87       101
           v       0.71      0.90      0.79        40
           w       0.86      0.67      0.76        46
           x       0.68      0.86      0.76        50
           y       0.92      0.91      0.91        88
           z       0.85      0.88      0.87        60
           |       0.87      0.93      0.90        43
### Results
    accuracy                           0.86      2456
   macro avg       0.85      0.86      0.85      2456
weighted avg       0.87      0.86      0.86      2456


## Using Data Augmentation, oversampled, 16 khz, interleave chan, len 10,928, new re-labeled dataset
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Apr-27-2023-11:38_tap2key/checkpoint-5525 (score: 0.9373599154814428).
{'train_runtime': 12062.0615, 'train_samples_per_second': 270.601, 'train_steps_per_second': 1.057, 'train_loss': 1.237776001450283, 'epoch': 81.0}     
 54%|█████████████████████████████████████████████████████████▏                                                | 6885/12750 [3:21:02<2:51:15,  1.75s/it]
***** Running Evaluation *****
  Num examples = 2433
  Batch size = 64
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:11<00:00,  3.40it/s]
TOTAL TIME: 13924.19
***** Running Prediction *****
  Num examples = 2456
  Batch size = 64
100%|████████████████████████████████████| 39/39 [00:11<00:00,  3.66it/s]TOTAL TIME: 107.57
              precision    recall  f1-score   support

          _1       0.88      0.61      0.72        38
          _2       0.82      0.86      0.84        74
          _3       0.81      0.95      0.88        44
          _4       0.79      0.94      0.86        68
          _5       0.89      0.82      0.86       102
          _6       0.96      0.87      0.92        63
           a       0.93      0.99      0.96       124
           b       0.95      0.98      0.97        58
           c       0.94      0.99      0.96        67
           d       0.94      0.97      0.95        62
           e       0.97      0.92      0.94       133
           f       0.95      0.98      0.97        58
           g       0.98      1.00      0.99        48
           h       0.94      0.98      0.96        83
           i       0.96      0.95      0.95       119
           j       0.87      0.96      0.91        49
           k       0.98      0.93      0.95        45
           l       0.98      0.98      0.98        52
           m       1.00      0.73      0.84        52
           n       0.88      0.97      0.93        71
        none       0.98      0.87      0.92        67
           o       0.97      0.96      0.96       137
           p       0.99      0.99      0.99        71
           q       1.00      0.92      0.96        49
           r       0.98      0.94      0.96        85
           s       0.99      0.98      0.99       106
           t       0.98      1.00      0.99       103
           u       0.95      0.95      0.95       101
           v       0.98      1.00      0.99        40
           w       0.85      0.96      0.90        46
           x       0.94      0.94      0.94        50
           y       0.93      0.95      0.94        88
           z       0.98      0.97      0.97        60
           |       0.98      0.98      0.98        43

    accuracy                           0.94      2456
   macro avg       0.94      0.93      0.93      2456
weighted avg       0.94      0.94      0.94      2456

[[23 14  0 ...  0  0  0]
 [ 0 64  9 ...  0  0  0]
 [ 0  0 42 ...  0  0  1]
 ...
 [ 1  0  0 ... 84  0  0]
 [ 0  0  0 ...  0 58  0]
 [ 0  0  0 ...  0  0 42]]
## Using Data Augmentation, oversampled, 16 khz, interleave chan, len 10,928, add gaussian noise to training set
Loading best model from /work/ajgeglio/pretrained_models/wav2vec2-base_Apr-08-2023-17:48_tap2key/checkpoint-5124 (score: 0.9247987185065054).
{'train_runtime': 21541.0734, 'train_samples_per_second': 150.814, 'train_steps_per_second': 0.585, 'train_loss': 0.8651363017067076, 'epoch': 149.99}
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 12600/12600 [5:59:01<00:00,  1.71s/it]
***** Running Evaluation *****
  Num examples = 2455
  Batch size = 64
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:10<00:00,  3.60it/s]
TOTAL TIME: 21562.59
***** Running Prediction *****
  Num examples = 2456
  Batch size = 64
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 39/39 [00:12<00:00,  3.69it/s]TOTAL TIME: 170.34
### Report
              precision    recall  f1-score   support

          _1       0.77      0.89      0.83        38
          _2       0.90      0.89      0.90        74
          _3       0.79      0.84      0.81        44
          _4       0.85      0.84      0.84        68
          _5       0.95      0.84      0.89       102
          _6       0.91      0.94      0.92        63
           a       0.93      0.95      0.94       124
           b       0.97      0.97      0.97        58
           c       0.90      0.96      0.93        67
           d       0.93      0.92      0.93        62
           e       0.93      0.94      0.93       133
           f       0.93      0.91      0.92        58
           g       0.96      0.96      0.96        48
           h       0.95      0.94      0.95        83
           i       0.98      0.91      0.94       119
           j       0.85      0.90      0.87        49
           k       0.87      0.89      0.88        45
           l       0.96      0.94      0.95        52
           m       0.94      0.92      0.93        52
           n       0.93      0.94      0.94        71
        none       0.96      0.96      0.96        67
           o       0.98      0.95      0.96       137
           p       0.97      0.96      0.96        71
           q       0.90      0.90      0.90        49
           r       0.92      0.93      0.92        85
           s       0.97      0.96      0.97       106
           t       0.94      0.95      0.95       103
           u       0.91      0.98      0.94       101
           v       0.93      0.97      0.95        40
           w       0.91      0.93      0.92        46
           x       0.90      0.92      0.91        50
           y       0.95      0.91      0.93        88
           z       0.97      0.93      0.95        60
           |       0.98      0.98      0.98        43
### Results
    accuracy                           0.93      2456
   macro avg       0.92      0.93      0.92      2456
weighted avg       0.93      0.93      0.93      2456

[[34  3  0 ...  0  0  0]
 [ 5 66  3 ...  0  0  0]
 [ 0  4 37 ...  0  0  1]
 ...
 [ 1  0  0 ... 80  0  0]
 [ 0  0  0 ...  0 56  0]
 [ 0  0  0 ...  0  0 42]]
## Other Stats
Creating Dataset
Saving evaluation dataset separately to: /work/ajgeglio/Tap_Data/04.Test_Dataset_96k                                                                
DATASET CREATION TIME: 8.37  (5.1e-4 s)                                                                                                                       
############# WAVEFORM ###################
Sample rate: 16000 
Real sample time(s): 0.085375 
Reshaped sample time(s): 0.683 
waveform shapes: original--> (8, 1366) -reshaped--> (10928,)
###########################################
/home/ajgeglio/anaconda/envs/Wav2vec/lib/python3.8/site-packages/transformers/configuration_utils.py:348: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
Feature Creation Time: 695.03 (0.061 s)                                                                                                                       
TOTAL TIME: 705.07   

Creating Dataset
Saving evaluation dataset separately to: /work/ajgeglio/Tap_Data/04.Test_Dataset_96k                                                                
Num of Examples:  DatasetDict({                                                                                                                     
    train: Dataset({
        features: ['audio', 'label'],
        num_rows: 11458
    })
    validation: Dataset({
        features: ['audio', 'label'],
        num_rows: 2455
    })
    evaluation: Dataset({
        features: ['audio', 'label'],
        num_rows: 2456
    })
})
DATASET CREATION TIME: 10.22
############# WAVEFORM ###################
Sample rate: 16000 
Real sample time(s): 0.085375 
Reshaped sample time(s): 0.683 
waveform shapes: original--> (8, 1366) -reshaped--> (10928,)
###########################################
/home/ajgeglio/anaconda/envs/Wav2vec/lib/python3.8/site-packages/transformers/configuration_utils.py:348: UserWarning: Passing `gradient_checkpointing` to a config initialization is deprecated and will be removed in v5 Transformers. Using `model.gradient_checkpointing_enable()` instead, or if you are using the `Trainer` API, pass `gradient_checkpointing=True` in your `TrainingArguments`.
  warnings.warn(
Feature Creation Time: 405.14                                                                                                                       
OVERSAMPLING TIME: 1170.43   (20 min)                                                                                                                       
TOTAL TIME: 1587.60

Creating Dataset
Saving test dataset separately to: /work/ajgeglio/Tap_Data/04.Test_Dataset_96k                                                                      
DatasetDict({                                                                                                                                       
    train: Dataset({
        features: ['label', 'input_values'],
        num_rows: 11458
    })
    validation: Dataset({
        features: ['label', 'input_values'],
        num_rows: 2455
    })
})
DATASET + FEATURE CREATION TIME: 357.23
OVERSAMPLING TIME: 1117.69  
                                                                                                                        
Dataset({
    features: ['label', 'input_values'],
    num_rows: 21658
})

## Keras Sequential Conv1d net. All data, oversampled, 16 khz, interleave chan, len 10,928
### Model
Model: "sequential"
 _________________________________________________________________
  Layer (type)                Output Shape              Param #   
 =================================================================
 conv1d (Conv1D)             (None, 2701, 512)         66048     
                                                                 
 batch_normalization (BatchN  (None, 2701, 512)        2048      
 ormalization)                                                   
                                                                 
 max_pooling1d (MaxPooling1D  (None, 1350, 512)        0         
 )                                                               
                                                                 
 dropout (Dropout)           (None, 1350, 512)         0         
                                                                 
 conv1d_1 (Conv1D)           (None, 306, 512)          33554944  
                                                                 
 batch_normalization_1 (Batc  (None, 306, 512)         2048      
 hNormalization)                                                 
                                                                 
 max_pooling1d_1 (MaxPooling  (None, 153, 512)         0         
 1D)                                                             
                                                                 
 dropout_1 (Dropout)         (None, 153, 512)          0         
                                                                 
 conv1d_2 (Conv1D)           (None, 45, 128)           4194432   
                                                                 
 batch_normalization_2 (Batc  (None, 45, 128)          512       
 hNormalization)                                                 
                                                                 
 max_pooling1d_2 (MaxPooling  (None, 22, 128)          0         
 1D)                                                             
                                                                 
 dropout_2 (Dropout)         (None, 22, 128)           0         
                                                                 
 flatten (Flatten)           (None, 2816)              0         
                                                                 
 dense (Dense)               (None, 128)               360576    
                                                                 
 dropout_3 (Dropout)         (None, 128)               0         
                                                                 
 dense_1 (Dense)             (None, 34)                4386      
                                                                 
=================================================================
Total params: 38,184,994
Trainable params: 38,182,690
Non-trainable params: 2,304
_________________________________________________________________

### Report
model_path = f'./convnet/Apr-07-2023-18.29/'
Dataset({
    features: ['label', 'input_values'],
    num_rows: 2456
})

77/77 [==============================] - 11s 110ms/step
              precision    recall  f1-score   support

          _1       0.83      0.63      0.72        38
          _2       0.79      0.82      0.81        74
          _3       0.69      0.86      0.77        44
          _4       0.86      0.63      0.73        68
          _5       0.81      0.89      0.85       102
          _6       0.88      0.90      0.89        63
           a       0.95      0.94      0.95       124
           b       1.00      0.72      0.84        58
           c       0.79      0.90      0.84        67
           d       0.98      0.95      0.97        62
           e       0.95      0.94      0.95       133
           f       0.95      0.93      0.94        58
           g       0.98      0.94      0.96        48
           h       0.94      0.95      0.95        83
           i       0.88      0.91      0.89       119
           j       0.90      0.92      0.91        49
           k       0.94      0.98      0.96        45
           l       0.98      1.00      0.99        52
           m       0.94      0.96      0.95        52
           n       0.83      0.94      0.88        71
        none       0.87      0.88      0.87        67
           o       0.98      0.91      0.95       137
           p       0.93      0.99      0.96        71
           q       0.98      0.88      0.92        49
           r       0.92      0.91      0.91        85
           s       0.96      0.93      0.95       106
           t       0.94      0.94      0.94       103
           u       0.92      0.90      0.91       101
           v       0.84      0.95      0.89        40
           w       0.90      0.96      0.93        46
           x       0.92      0.88      0.90        50
           y       0.93      0.93      0.93        88
           z       0.88      0.95      0.91        60
           |       0.98      0.98      0.98        43
### Results
    accuracy                           0.91      2456
   macro avg       0.91      0.90      0.90      2456
weighted avg       0.91      0.91      0.91      2456


## Wav2Vec 2.0 Model

l (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Some weights of Wav2Vec2ForSequenceClassification were not initialized from the model checkpoint at facebook/wav2vec2-base and are newly initialized: ['projector.weight', 'classifier.weight', 'classifier.bias', 'projector.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Wav2Vec2ForSequenceClassification(
  (wav2vec2): Wav2Vec2Model(
    (feature_extractor): Wav2Vec2FeatureExtractor(
      (conv_layers): ModuleList(
        (0): Wav2Vec2GroupNormConvLayer(
          (conv): Conv1d(1, 512, kernel_size=(10,), stride=(5,), bias=False)
          (layer_norm): GroupNorm(512, 512, eps=1e-05, affine=True)
        )
        (1): Wav2Vec2NoLayerNormConvLayer(
          (conv): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
        )
        (2): Wav2Vec2NoLayerNormConvLayer(
          (conv): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
        )
        (3): Wav2Vec2NoLayerNormConvLayer(
          (conv): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
        )
        (4): Wav2Vec2NoLayerNormConvLayer(
          (conv): Conv1d(512, 512, kernel_size=(3,), stride=(2,), bias=False)
        )
        (5): Wav2Vec2NoLayerNormConvLayer(
          (conv): Conv1d(512, 512, kernel_size=(2,), stride=(2,), bias=False)
        )
        (6): Wav2Vec2NoLayerNormConvLayer(
          (conv): Conv1d(512, 512, kernel_size=(2,), stride=(2,), bias=False)
        )
      )
    )
    (feature_projection): Wav2Vec2FeatureProjection(
      (layer_norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
      (projection): Linear(in_features=512, out_features=768, bias=True)
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (encoder): Wav2Vec2Encoder(
      (pos_conv_embed): Wav2Vec2PositionalConvEmbedding(
        (conv): Conv1d(768, 768, kernel_size=(128,), stride=(1,), padding=(64,), groups=16)
        (padding): Wav2Vec2SamePadLayer()
      )
      (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
      (dropout): Dropout(p=0.1, inplace=False)
      (layers): ModuleList(
        (0): Wav2Vec2EncoderLayer(
          (attention): Wav2Vec2Attention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (dropout): Dropout(p=0.1, inplace=False)
          (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (feed_forward): Wav2Vec2FeedForward(
            (intermediate_dropout): Dropout(p=0.0, inplace=False)
            (intermediate_dense): Linear(in_features=768, out_features=3072, bias=True)
            (output_dense): Linear(in_features=3072, out_features=768, bias=True)
            (output_dropout): Dropout(p=0.1, inplace=False)
          )
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (1): Wav2Vec2EncoderLayer(
          (attention): Wav2Vec2Attention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (dropout): Dropout(p=0.1, inplace=False)
          (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (feed_forward): Wav2Vec2FeedForward(
            (intermediate_dropout): Dropout(p=0.0, inplace=False)
            (intermediate_dense): Linear(in_features=768, out_features=3072, bias=True)
            (output_dense): Linear(in_features=3072, out_features=768, bias=True)
            (output_dropout): Dropout(p=0.1, inplace=False)
          )
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (2): Wav2Vec2EncoderLayer(
          (attention): Wav2Vec2Attention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (dropout): Dropout(p=0.1, inplace=False)
          (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (feed_forward): Wav2Vec2FeedForward(
            (intermediate_dropout): Dropout(p=0.0, inplace=False)
            (intermediate_dense): Linear(in_features=768, out_features=3072, bias=True)
            (output_dense): Linear(in_features=3072, out_features=768, bias=True)
            (output_dropout): Dropout(p=0.1, inplace=False)
          )
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (3): Wav2Vec2EncoderLayer(
          (attention): Wav2Vec2Attention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (dropout): Dropout(p=0.1, inplace=False)
          (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (feed_forward): Wav2Vec2FeedForward(
            (intermediate_dropout): Dropout(p=0.0, inplace=False)
            (intermediate_dense): Linear(in_features=768, out_features=3072, bias=True)
            (output_dense): Linear(in_features=3072, out_features=768, bias=True)
            (output_dropout): Dropout(p=0.1, inplace=False)
          )
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (4): Wav2Vec2EncoderLayer(
          (attention): Wav2Vec2Attention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (dropout): Dropout(p=0.1, inplace=False)
          (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (feed_forward): Wav2Vec2FeedForward(
            (intermediate_dropout): Dropout(p=0.0, inplace=False)
            (intermediate_dense): Linear(in_features=768, out_features=3072, bias=True)
            (output_dense): Linear(in_features=3072, out_features=768, bias=True)
            (output_dropout): Dropout(p=0.1, inplace=False)
          )
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (5): Wav2Vec2EncoderLayer(
          (attention): Wav2Vec2Attention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (dropout): Dropout(p=0.1, inplace=False)
          (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (feed_forward): Wav2Vec2FeedForward(
            (intermediate_dropout): Dropout(p=0.0, inplace=False)
            (intermediate_dense): Linear(in_features=768, out_features=3072, bias=True)
            (output_dense): Linear(in_features=3072, out_features=768, bias=True)
            (output_dropout): Dropout(p=0.1, inplace=False)
          )
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (6): Wav2Vec2EncoderLayer(
          (attention): Wav2Vec2Attention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (dropout): Dropout(p=0.1, inplace=False)
          (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (feed_forward): Wav2Vec2FeedForward(
            (intermediate_dropout): Dropout(p=0.0, inplace=False)
            (intermediate_dense): Linear(in_features=768, out_features=3072, bias=True)
            (output_dense): Linear(in_features=3072, out_features=768, bias=True)
            (output_dropout): Dropout(p=0.1, inplace=False)
          )
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (7): Wav2Vec2EncoderLayer(
          (attention): Wav2Vec2Attention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (dropout): Dropout(p=0.1, inplace=False)
          (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (feed_forward): Wav2Vec2FeedForward(
            (intermediate_dropout): Dropout(p=0.0, inplace=False)
            (intermediate_dense): Linear(in_features=768, out_features=3072, bias=True)
            (output_dense): Linear(in_features=3072, out_features=768, bias=True)
            (output_dropout): Dropout(p=0.1, inplace=False)
          )
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (8): Wav2Vec2EncoderLayer(
          (attention): Wav2Vec2Attention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (dropout): Dropout(p=0.1, inplace=False)
          (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (feed_forward): Wav2Vec2FeedForward(
            (intermediate_dropout): Dropout(p=0.0, inplace=False)
            (intermediate_dense): Linear(in_features=768, out_features=3072, bias=True)
            (output_dense): Linear(in_features=3072, out_features=768, bias=True)
            (output_dropout): Dropout(p=0.1, inplace=False)
          )
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (9): Wav2Vec2EncoderLayer(
          (attention): Wav2Vec2Attention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (dropout): Dropout(p=0.1, inplace=False)
          (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (feed_forward): Wav2Vec2FeedForward(
            (intermediate_dropout): Dropout(p=0.0, inplace=False)
            (intermediate_dense): Linear(in_features=768, out_features=3072, bias=True)
            (output_dense): Linear(in_features=3072, out_features=768, bias=True)
            (output_dropout): Dropout(p=0.1, inplace=False)
          )
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (10): Wav2Vec2EncoderLayer(
          (attention): Wav2Vec2Attention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (dropout): Dropout(p=0.1, inplace=False)
          (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (feed_forward): Wav2Vec2FeedForward(
            (intermediate_dropout): Dropout(p=0.0, inplace=False)
            (intermediate_dense): Linear(in_features=768, out_features=3072, bias=True)
            (output_dense): Linear(in_features=3072, out_features=768, bias=True)
            (output_dropout): Dropout(p=0.1, inplace=False)
          )
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
        (11): Wav2Vec2EncoderLayer(
          (attention): Wav2Vec2Attention(
            (k_proj): Linear(in_features=768, out_features=768, bias=True)
            (v_proj): Linear(in_features=768, out_features=768, bias=True)
            (q_proj): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
          )
          (dropout): Dropout(p=0.1, inplace=False)
          (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (feed_forward): Wav2Vec2FeedForward(
            (intermediate_dropout): Dropout(p=0.0, inplace=False)
            (intermediate_dense): Linear(in_features=768, out_features=3072, bias=True)
            (output_dense): Linear(in_features=3072, out_features=768, bias=True)
            (output_dropout): Dropout(p=0.1, inplace=False)
          )
          (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
        )
      )
    )
  )
  (projector): Linear(in_features=768, out_features=256, bias=True)
  (classifier): Linear(in_features=256, out_features=34, bias=True)
)